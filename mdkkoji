#!/usr/bin/env perl

use v5.14;
use warnings;
use strict;

use FindBin;
use Pod::Usage;
use Cwd qw/ abs_path /;
use Getopt::Long;

GetOptions('config=s', \(my $path));
$ENV{MDKKOJI_CONFIG_PATH} = $path ? abs_path($path) : 'config.pl';

chdir $FindBin::RealBin;

given(shift) {
	when ('start')  { exec($^X, 'start.pl') }
	when ('init')   { exec($^X, 'init.pl') }
	when ('stop')   { exec($^X, 'stop.pl') }
	when ('update') { exec($^X, 'update.pl') }
	default {
		pod2usage(-verbose => 99);
	}
}

__END__

=pod

=head1 NAME

mdkkoji

=head1 SYNOPSIS

mdkkoji [ I<options> ] [ I<commands> ]

=head1 DESCRIPTION

Program for organizing markdown documents.

=head2 Commands

=over 10

=item C<init>

Test configuration and initialize database. 

=item C<start>

Start mdkkoji server.

=item C<stop>

Stop mdkkoji server.

=item C<update>

Update database.

=back

=head2 Options

=over 25

=item C<--config [filename]>

run with specified config file

=back